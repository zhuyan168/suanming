# 🎴 掷筊占卜 v2.0 - 真实木质圣杯版

## 📋 项目概述

全新设计的掷筊占卜模块，采用**真实木质红色圣杯**视觉设计，模拟传统掷筊的完整体验。

---

## ✨ 核心特性

### 🪵 真实木质圣杯
- 深红色木质材质 (#A02424)
- 手工漆面光泽效果
- 半月形/贝壳形传统造型
- 正面凸起，反面平面
- 细腻的光影和纹理

### 🎬 逼真动画效果
- **抛起**：从底部快速弹起
- **旋转**：空中三轴旋转 2-3 圈
- **落地**：重力下落 + 轻微弹跳
- **光晕**：落地时金红色光晕扩散
- **总时长**：1.8 秒完整体验

### 🎯 智能随机系统
- 每次落地位置随机偏移
- 避免两块圣杯重叠
- 落地后随机旋转角度
- 真实物理轨迹

### 📱 完美响应式
- 支持手机、平板、桌面
- 流畅的 60fps 动画
- GPU 加速渲染

---

## 📁 文件结构

```
pages/
├── divination/
│   └── jiaobei/
│       ├── index.tsx          ✅ 掷筊详情页（已更新）
│       └── result.tsx         ✅ 结果页
│
docs/
├── JIAOBEI_README.md          📖 本文件（项目总览）
├── JIAOBEI_DESIGN.md          🎨 详细设计文档
├── JIAOBEI_USAGE.md           📘 使用说明
├── JIAOBEI_FEATURE.md         📝 功能说明
└── CHANGELOG_JIAOBEI.md       📋 更新日志
```

---

## 🚀 快速开始

### 1. 启动项目

```bash
npm run dev
```

### 2. 访问页面

- **主页**: `http://localhost:3000`
- **掷筊页**: `http://localhost:3000/divination/jiaobei`

### 3. 使用流程

1. 心中默念问题
2. 点击「开始掷筊」
3. 观看动画（1.8秒）
4. 查看结果
5. 自动跳转详情页

---

## 🎨 视觉设计

### 颜色系统

| 颜色名称 | 代码 | 用途 |
|---------|------|------|
| 深红色 | `#A02424` | 圣杯主体色 |
| 金红色 | `#D95B43` | 高光/光泽 |
| 暗红色 | `#5C1A1A` | 阴影 |
| 深暗红 | `#3d0f0f` | 反面平面 |
| 深紫黑 | `#191022` | 背景色 |

### 木质圣杯特征

#### 正面（凸起）
```
🌕 深红色光泽表面
├─ 顶部高光（模拟漆面反射）
├─ 三层渐变（高光→主体→阴影）
├─ 内外阴影（立体感）
└─ 半月形轮廓
```

#### 反面（平面）
```
🌑 暗红色平面
├─ 深色渐变
├─ 木纹纹理
├─ 内凹阴影
└─ 无明显高光
```

---

## 🎬 动画时间轴

```
动画总时长：1.8 秒

0.0s ─────────────────────────────────────── 1.8s
 │                                           │
 ├─ 0-0.27s    抛起（快速上升）
 │
 ├─ 0.27-0.72s 最高点（悬停旋转）
 │
 ├─ 0.72-1.53s 下落（重力加速）
 │
 ├─ 1.53-1.66s 落地（光晕扩散）
 │
 └─ 1.66-1.8s  弹跳（稳定静止）
```

### 旋转效果

- **rotateX**: 前后翻转（决定正反面）
- **rotateY**: 左右旋转（增加真实感）
- **rotateZ**: 平面旋转（落地倾斜）

**总旋转圈数：**
- X 轴：3 圈（1080°）
- Y 轴：2.5 圈（900°）
- Z 轴：随机角度

---

## 🎯 占卜结果

| 结果 | 图标 | 含义 | 说明 |
|------|------|------|------|
| **圣筊** | 🌕🌑 | 一正一反 | 此事可行，神明允准 |
| **阴筊** | 🌕🌕 | 两正 | 暂缓行事，宜再思量 |
| **笑筊** | 🌑🌑 | 两反 | 神明含笑未答，再问一次 |

---

## 💻 技术实现

### 核心技术栈

- **框架**: Next.js 16 (Pages Router)
- **语言**: TypeScript
- **样式**: Tailwind CSS + 原生 CSS
- **动画**: CSS Keyframes + Transform
- **3D**: CSS 3D Transform

### 关键代码说明

#### 1. 木质圣杯样式

```typescript
// 位置：pages/divination/jiaobei/index.tsx 第 323-410 行

/* ========== 木质圣杯样式 ========== */
正面：深红渐变 + 高光 + 阴影
反面：暗红渐变 + 木纹纹理
```

#### 2. 动画关键帧

```typescript
// 位置：pages/divination/jiaobei/index.tsx 第 108-168 行

@keyframes throwBlock      // 抛起 + 旋转 + 落地
@keyframes landingGlow     // 落地光晕扩散
@keyframes fadeInResult    // 结果文字淡入
```

#### 3. CSS 变量控制

```typescript
// 位置：pages/divination/jiaobei/index.tsx 第 308-315 行

--throw-x-start    // 起始位置
--throw-x-mid      // 最高点位置
--final-x/y        // 最终位置
--final-rotation   // 最终旋转
--final-flip       // 正反面控制
```

### 性能优化

- ✅ GPU 加速（CSS transform）
- ✅ 减少重绘（backfaceVisibility: hidden）
- ✅ 固定尺寸（避免布局抖动）
- ✅ 单次动画（不循环）

---

## 📊 对比表

### v1.0 vs v2.0

| 特性 | v1.0 | v2.0 |
|------|------|------|
| **外观** | 简单蛋形 | 真实木质圣杯 |
| **材质** | 单一渐变 | 三层渐变 + 光泽 |
| **颜色** | 金色/紫色 | 深红色系 |
| **动画** | 基础抖动 | 完整抛起落地 |
| **旋转** | 单轴 | 三轴旋转 |
| **时长** | 2秒 | 1.8秒 |
| **物理** | 无 | 重力 + 弹跳 |
| **光效** | 无 | 落地光晕 |
| **随机** | 固定位置 | 随机偏移 |
| **结果** | 立即跳转 | 预览 + 延迟跳转 |

---

## 📚 文档导航

### 快速链接

- 📖 **[JIAOBEI_DESIGN.md](./JIAOBEI_DESIGN.md)**
  - 完整的设计文档
  - CSS 代码详解
  - 动画原理说明

- 📘 **[JIAOBEI_USAGE.md](./JIAOBEI_USAGE.md)**
  - 用户使用指南
  - 常见问题解答
  - 使用技巧

- 📝 **[JIAOBEI_FEATURE.md](./JIAOBEI_FEATURE.md)**
  - 功能特性说明
  - 技术栈介绍
  - 路由配置

- 📋 **[CHANGELOG_JIAOBEI.md](./CHANGELOG_JIAOBEI.md)**
  - 详细更新日志
  - 版本对比
  - Bug 修复记录

---

## 🎭 设计理念

### 仪式感

通过完整的动画时间轴营造占卜的仪式感：
1. **抛起**：紧张感、期待感
2. **最高点**：悬念感
3. **下落**：期待感加强
4. **落地**：揭晓感
5. **弹跳**：真实感

### 神秘感

通过视觉和材质营造神秘氛围：
- 木质红色（传统材质）
- 深暗背景（夜空般）
- 柔和光晕（神性）
- 动态阴影（立体感）

### 真实感

模拟真实掷筊的物理过程：
- 重力下落
- 空中旋转
- 落地弹跳
- 随机偏移

---

## ⚠️ 注意事项

### 浏览器兼容性

推荐使用现代浏览器：
- ✅ Chrome ≥ 90
- ✅ Firefox ≥ 88
- ✅ Safari ≥ 14
- ✅ Edge ≥ 90
- ❌ IE 11（不支持）

### 性能要求

- 建议在性能较好的设备上使用
- 低端设备可能出现动画卡顿
- 需要支持 CSS 3D Transform

### 免责声明

- 占卜结果仅供娱乐参考
- 不构成任何专业建议
- 重大决策请谨慎判断
- 结合实际情况综合考虑

---

## 🛠️ 开发指南

### 本地开发

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 启动生产服务器
npm start
```

### 代码结构

```typescript
export default function JiaoBeiPage() {
  // 状态管理
  const [isAnimating, setIsAnimating] = useState(false);
  const [blocks, setBlocks] = useState<Block[]>([...]);
  
  // 掷筊逻辑
  const throwBlocks = () => {
    // 1. 随机生成结果
    // 2. 设置最终位置
    // 3. 触发动画
    // 4. 显示结果
    // 5. 自动跳转
  };
  
  return (
    // JSX 渲染
  );
}
```

### 自定义配置

可以调整的参数：

```typescript
// 动画时长
const animationDuration = 1800; // 毫秒

// 偏移范围
finalX: -60 + (Math.random() - 0.5) * 30; // ±15px

// 旋转角度
finalRotation: (Math.random() - 0.5) * 30; // ±15°
```

---

## 🚀 未来规划

### 可能的增强功能

1. **音效系统**
   - 掷筊抛起音效
   - 落地撞击音效
   - 背景氛围音乐

2. **粒子效果**
   - Canvas/Three.js 粒子
   - 落地光点扩散

3. **更多交互**
   - 手动拖拽掷筊
   - 摇一摇触发
   - 长按蓄力

4. **数据功能**
   - 历史记录
   - 统计分析
   - 社交分享

---

## 📞 技术支持

### 常见问题

**Q: 动画卡顿怎么办？**
A: 使用现代浏览器，确保硬件加速已开启

**Q: 如何调整动画速度？**
A: 修改 `animationDuration` 变量（第 75 行）

**Q: 如何修改圣杯颜色？**
A: 修改渐变色配置（第 336, 380 行）

### 获取帮助

- 查看详细文档
- 检查浏览器控制台
- 联系开发团队

---

## 🎉 致谢

感谢所有为这个项目贡献的人！

特别感谢传统文化的传承者们，让我们能够通过现代科技体验和传播这些宝贵的文化遗产。

---

## 📜 许可证

本项目仅供学习和娱乐使用。

---

**✨ 愿神明指引你的方向，祝占卜顺利！**

---

*文档版本：2.0*
*最后更新：2025-01-09*
*作者：Claude (Anthropic)*

