# 四季牌阵功能测试指南

## 测试前准备

### 1. 环境配置
确保已在 `.env.local` 文件中配置 DeepSeek API Key：
```env
DEEPSEEK_API_KEY=your_actual_api_key
```

### 2. 启动开发服务器
```bash
npm run dev
```

访问 http://localhost:3000

## 测试流程

### 第一步：进入四季牌阵页面
1. 从首页导航到四季牌阵功能
2. 访问路径：`/fortune/seasonal`
3. 验证页面正常加载，显示78张塔罗牌背面

### 第二步：抽取五张牌
1. **第1张牌 - 权杖牌组（行动与主动性）**
   - 点击任意卡片
   - 验证：卡片飞入左侧槽位，标签显示"Wands - 权杖牌组"
   - API调用：`/api/seasonal-draw?slot=1`
   
2. **第2张牌 - 圣杯牌组（情感和人际关系）**
   - 点击另一张卡片
   - 验证：卡片飞入右侧槽位，标签显示"Cups - 圣杯牌组"
   - API调用：`/api/seasonal-draw?slot=2`
   
3. **第3张牌 - 宝剑牌组（智慧与思想）**
   - 点击第三张卡片
   - 验证：卡片飞入下方槽位，标签显示"Swords - 宝剑牌组"
   - API调用：`/api/seasonal-draw?slot=3`
   
4. **第4张牌 - 星币牌组（事业和财运）**
   - 点击第四张卡片
   - 验证：卡片飞入上方槽位，标签显示"Pentacles - 星币牌组"
   - API调用：`/api/seasonal-draw?slot=4`
   
5. **第5张牌 - 大阿卡那（本季核心主题）**
   - 点击第五张卡片
   - 验证：卡片飞入中心槽位，标签显示"Major Arcana - 大阿尔卡纳"
   - 验证：中心卡片有金色边框和特殊光晕效果
   - API调用：`/api/seasonal-draw?slot=5`

### 第三步：查看结果
1. 抽完5张牌后，自动出现"开始测算"按钮
2. 点击"开始测算"按钮
3. 验证：跳转到结果页面 `/fortune/seasonal/result`

### 第四步：验证结果页面
1. **卡片展示**
   - 验证：5张卡片以十字形布局展示
   - 验证：所有卡片都已翻面，显示正面
   - 验证：中心卡片（核心主题）有特殊高亮

2. **AI 解读加载**
   - 验证：显示"AI 正在为你生成深度解读..."加载提示
   - API调用：`POST /api/seasonal-reading`
   - 等待时间：通常5-15秒

3. **解读内容展示**
   验证以下6个部分都正确显示：
   
   - ✨ **本季核心能量** (紫色高亮框)
     - 图标：auto_awesome
     - 显示第5张牌（大阿卡那）的名称和正逆位
     - 内容长度：约200字
   
   - ⚡ **行动（Action）**
     - 图标：bolt (黄色)
     - 显示第1张牌（权杖）的名称和正逆位
     - 内容长度：约150字
   
   - 💗 **情绪与人际（Emotion）**
     - 图标：favorite (粉色)
     - 显示第2张牌（圣杯）的名称和正逆位
     - 内容长度：约150字
   
   - 🧠 **思维（Mind）**
     - 图标：psychology (蓝色)
     - 显示第3张牌（宝剑）的名称和正逆位
     - 内容长度：约150字
   
   - 💰 **现实事务（Material）**
     - 图标：account_balance_wallet (绿色)
     - 显示第4张牌（星币）的名称和正逆位
     - 内容长度：约150字
   
   - 🧭 **综合建议** (紫色高亮框)
     - 图标：explore
     - 内容长度：约150字

### 第五步：测试其他功能
1. **重新抽牌**
   - 点击"重新抽牌"按钮
   - 验证：localStorage被清除
   - 验证：跳转回抽牌页面
   - 验证：可以重新抽取新的5张牌

2. **返回首页**
   - 点击"返回首页"按钮
   - 验证：跳转到首页

3. **直接访问结果页**
   - 抽完牌后，直接访问 `/fortune/seasonal/result`
   - 验证：显示之前抽取的5张牌
   - 验证：自动调用AI生成新的解读

## 错误处理测试

### 1. API调用失败
- 测试方法：临时使用错误的API Key
- 预期结果：显示错误提示和"重试"按钮
- 验证：点击重试按钮可以重新请求

### 2. 无历史记录访问结果页
- 测试方法：清除localStorage后直接访问 `/fortune/seasonal/result`
- 预期结果：自动跳转回抽牌页面 `/fortune/seasonal`

### 3. 网络中断
- 测试方法：开发者工具中模拟离线
- 预期结果：显示友好的错误提示

## 性能测试

### 响应时间基准
- 单次抽牌API调用：< 200ms
- AI解读生成：5-15秒
- 页面切换：< 100ms

### 内存使用
- 页面加载后内存占用：< 50MB
- 抽完5张牌后：< 80MB

## 浏览器兼容性测试

测试以下浏览器：
- ✅ Chrome (最新版)
- ✅ Firefox (最新版)
- ✅ Safari (最新版)
- ✅ Edge (最新版)
- ✅ 移动端 Safari (iOS)
- ✅ 移动端 Chrome (Android)

## 已知问题

无

## 测试检查清单

- [ ] 环境变量正确配置
- [ ] 78张卡片正确显示
- [ ] 5张牌按顺序抽取到正确位置
- [ ] 卡片翻转动画流畅
- [ ] localStorage正确保存和读取
- [ ] AI解读API调用成功
- [ ] 6个解读部分都正确显示
- [ ] 重新抽牌功能正常
- [ ] 错误处理正确
- [ ] 移动端响应式布局正常
- [ ] 所有按钮和链接工作正常

## 调试技巧

### 查看API调用日志
打开浏览器开发者工具 → Network标签：
- 查看 `seasonal-draw` 请求：验证抽牌逻辑
- 查看 `seasonal-reading` 请求：验证AI解读调用

### 查看localStorage
开发者工具 → Application → Local Storage：
```javascript
// 查看保存的结果
localStorage.getItem('seasonal_fortune_result')

// 清除保存的结果（用于重新测试）
localStorage.removeItem('seasonal_fortune_result')
```

### 查看控制台日志
- 抽牌成功：`🎴 抽到第X张卡牌: [牌名], 正逆位: [正位/逆位]`
- 保存成功：`✅ 五张牌抽取完成，已保存到localStorage`

## 反馈与改进

如发现问题，请记录：
1. 问题描述
2. 复现步骤
3. 浏览器和版本
4. 控制台错误信息
5. 截图（如有）

